README –ù–ê–ü–ò–°–ê–ù –ß–ê–¢–û–ú –ì–ü–¢. –¢–†–ï–ë–£–ï–¢–°–Ø –ü–ï–†–ï–ü–ò–°–ê–¢–¨!!!!!
------------------------------------------------------------------------------------------------------------------------
Thought for 16 seconds
markdown
Copy
Edit
# –û–±–æ–±—â—ë–Ω–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—é Sinaibot

–ë—Ä–∞—Ç, –Ω–∏–∂–µ –≤—Å—è –∫–∞—Ä—Ç–∏–Ω–∞: —á—Ç–æ –∏ –∫–∞–∫ –ª–µ–∂–∏—Ç, –∫–∞–∫–∏–µ —Ñ–∞–π–ª—ã –≥–¥–µ, –∫–∞–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã z–∞–ø—É—Å–∫–∞—Ç—å.

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

sinaibot/
‚îú‚îÄ‚îÄ ai.go # –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ LLAMA –∏ OpenAI
‚îú‚îÄ‚îÄ sessions.go # —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, /ai, /billing, –∫–∞–ø—á–∞
‚îú‚îÄ‚îÄ client.go # HTTP-–∫–ª–∏–µ–Ω—Ç Telegram (sendMessage, editMessage‚Ä¶)
‚îú‚îÄ‚îÄ polling.go # long-poll, MessageEvent/InlineEvent/NewMemberEvent
‚îú‚îÄ‚îÄ utils.go # –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–ø–∞–π–∏–Ω–≥, –∫–∞–ø—á–∞, —á—Ç–µ–Ω–∏–µ msgs, —Å—Ç—Ä–∏–º
‚îú‚îÄ‚îÄ go.mod
‚îú‚îÄ‚îÄ go.sum

‚îú‚îÄ‚îÄ python/
‚îÇ ‚îú‚îÄ‚îÄ venv/ # –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
‚îÇ ‚îî‚îÄ‚îÄ captcha.py # —Å–∫—Ä–∏–ø—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞–ø—á–∏

‚îú‚îÄ‚îÄ configs/
‚îÇ ‚îú‚îÄ‚îÄ tgkeys2 # –¥–≤–∞ —Ç–æ–∫–µ–Ω–∞ Telegram (prod –∏ alert)
‚îÇ ‚îú‚îÄ‚îÄ openai_token # –∫–ª—é—á OpenAI (–±–µ–∑ –ª–∏—à–Ω–µ–≥–æ –ø–µ—Ä–µ–Ω–æ—Å–∞ —Å—Ç—Ä–æ–∫–∏)
‚îÇ ‚îú‚îÄ‚îÄ openai_billing # –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: total\nprompt\ncompletion\ncount
‚îÇ ‚îî‚îÄ‚îÄ msgs # –ª–æ–≥ —á–∞—Ç–∞ (—Å–ø–∏—Å–æ–∫ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)

‚îú‚îÄ‚îÄ captcha/ # —Å—é–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è PNG-–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞–ø—á –ø–æ userID
‚îú‚îÄ‚îÄ log # –æ–±—â–∏–π –ª–æ–≥ –æ—à–∏–±–æ–∫
‚îî‚îÄ‚îÄ README.md # —ç—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

yaml
Copy
Edit

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

1. **–°–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–µ—Ä–µ–π—Ç–∏**  
   ```bash
   git clone <repo-url> sinaibot
   cd sinaibot
Go-–º–æ–¥—É–ª–∏

bash
Copy
Edit
go mod tidy
Python-–∫–∞–ø—á–∞

bash
Copy
Edit
cd python
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt  # –µ—Å–ª–∏ –Ω—É–∂–Ω—ã Pillow –∏ –¥—Ä.
deactivate
cd ..
–°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫–∏ –∏ —Ñ–∞–π–ª—ã

bash
Copy
Edit
mkdir captcha
touch log
chmod 664 log

# configs/tgkeys2:
# –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî production token,
# –≤—Ç–æ—Ä–∞—è ‚Äî alert token
vim configs/tgkeys2

# configs/openai_token:
# –≤–∞—à –∫–ª—é—á OpenAI, –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤ –∏ –ª–∏—à–Ω–∏—Ö –ø–µ—Ä–µ–≤–æ–¥–æ–≤ —Å—Ç—Ä–æ–∫–∏
vim configs/openai_token

# configs/openai_billing:
# –Ω–∞–ø—Ä–∏–º–µ—Ä:
# 0.000000
# 0.000000
# 0.000000
# 0
vim configs/openai_billing

# configs/msgs ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—É—Å—Ç—ã–º:
touch configs/msgs
–ü—Ä–∞–≤–∞ –∏ –ø—É—Ç–∏

utils.go –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø–∏—à–µ—Ç –ª–æ–≥–∏ –≤ log –∏ configs/msgs.

–ï—Å–ª–∏ –≤ –ø—Ä–æ–¥–µ –≤—Å—ë –ª–µ–∂–∏—Ç –≤ /home/sinaibot/..., –ø–æ–ø—Ä–∞–≤—å—Ç–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã logpath –∏ spioniro_golubiro_path.

üöÄ –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
–ü—Ä–æ—Å—Ç–µ–π—à–∏–π z–∞–ø—É—Å–∫:

bash
Copy
Edit
# –≤ –∫–æ—Ä–Ω–µ sinaibot/
go run *.go
–ò–ª–∏ —Å–æ–±—Ä–∞—Ç—å –±–∏–Ω–∞—Ä–Ω–∏–∫:

bash
Copy
Edit
go build -o sinaibot *.go
./sinaibot
–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ —Å—Ç–∞—Ä—Ç–µ

client.go –∑–∞–≥—Ä—É–∂–∞–µ—Ç configs/tgkeys2 –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç botToken.

polling.go –∑–∞–ø—É—Å–∫–∞–µ—Ç long-poll, –æ—Ç–¥–∞–≤–∞—è —Ç—Ä–∏ –∫–∞–Ω–∞–ª–∞: msgCh, inlineCh, newMemCh.

sessions.go —Å–ª—É—à–∞–µ—Ç —ç—Ç–∏ –∫–∞–Ω–∞–ª—ã, —Å–æ–∑–¥–∞—ë—Ç UserSession, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã /ai, /billing –∏ –∫–∞–ø—á—É.

ai.go —É–º–µ–µ—Ç –¥–µ—Ä–≥–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–µ LLAMA-–º–æ–¥–µ–ª–∏ –∏ OpenAI, —Å—á–∏—Ç–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å –∏ –ø–∏—à–µ—Ç –≤ configs/openai_billing.

utils.go –ª–æ–≥–∏—Ä—É–µ—Ç –æ—à–∏–±–∫–∏, –ø–∏—à–µ—Ç –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –≤ configs/msgs, –≥–µ–Ω–µ—Ä–∏—Ç –∫–∞–ø—á—É —á–µ—Ä–µ–∑ Python-—Å–∫—Ä–∏–ø—Ç –∏ —á–∏—Ç–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å–æ–æ–±—â–µ–Ω–∏–π.

üìå –ö–∞–∫ —Ç–µ—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
–ò–º–∏—Ç–∞—Ü–∏—è –Ω–æ–≤—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ —á–∞—Ç —Å–µ—Ä–≤–∏—Å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å new_chat_members.

–ö–æ–º–∞–Ω–¥–∞ /billing

–í —á–∞—Ç: /billing ‚Üí –±–æ—Ç –ø—Ä–∏—à–ª—ë—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ configs/openai_billing.

–ö–æ–º–∞–Ω–¥–∞ /ai

–í —á–∞—Ç:

bash
Copy
Edit
/ai -model=gpt -context=t –ü—Ä–∏–≤–µ—Ç, –±—Ä–∞—Ç!
–ë–æ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ç –æ—Ç–≤–µ—Ç –∏ –æ–±–Ω–æ–≤–∏—Ç –±–∏–ª–ª–∏–Ω–≥.

–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–ø—á–∏

–ù–æ–≤—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ ‚Üí –±–æ—Ç –ø—Ä–∏—à–ª—ë—Ç –∫–∞—Ä—Ç–∏–Ω–∫—É –≤ captcha/<userID>.png,

–í—ã –æ—Ç–≤–µ—Ç–∏–ª–∏ —Ç–µ–∫—Å—Ç–æ–º ‚Üí sessions.go –ø—Ä–æ–≤–µ—Ä–∏—Ç —á–µ—Ä–µ–∑ utils.CheckCaptcha.


------------------------------------------------------------------------------------------------------------------------
main.go
üöÄ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Ñ—É–Ω–∫—Ü–∏–∏
1. –•—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ—Å—Å–∏–π
chatid_to_user map[int64]telegramUser ‚Äî –≥–ª–æ–±–∞–ª—å–Ω—ã–π –º–∞–ø –¥–ª—è –º–∞–ø–ø–∏–Ω–≥–∞ chatID ‚Üí –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

UserSession ‚Äî —Ö—Ä–∞–Ω–∏—Ç userID, –∫–∞–Ω–∞–ª messageChan, —Ç–∞–π–º—Å—Ç–µ–º–ø lastActivity, –∫–ª–∏–µ–Ω—Ç TG –∏ –¥–∞–Ω–Ω—ã–µ telegramUser.

newUserSession(uid, c) ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏.

2. –ö–æ–º–∞–Ω–¥–∞ /billing
go
Copy
Edit
func getbilling(msg string, c *tgClient, chatid int64)
–ï—Å–ª–∏ msg == "/billing", —á–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª –±–∏–ª–ª–∏–Ω–≥–∞ –∏ —à–ª—ë—Ç –µ–≥–æ –≤ —á–∞—Ç.

–õ–æ–≥–≥–∏—Ä—É–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫–∏ —á–µ—Ä–µ–∑ logerr.

3. –û–±—Ä–∞–±–æ—Ç–∫–∞ AI-–∑–∞–ø—Ä–æ—Å–∞ /ai
go
Copy
Edit
func checkai_req(msg string, chatID int64, username string, c *tgClient)
–ü–∞—Ä—Å–∏—Ç —Ñ–ª–∞–≥–∏ -model= –∏ -context=.

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–æ–¥–µ–ª–∏:

llama ‚Üí –ø–æ—Ç–æ–∫–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å streamGenerateTextLLAMA70

llama7b ‚Üí —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π CheckLLAMA9

llama13b ‚Üí —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π WizardLM-13B

gpt ‚Üí –≤—ã–∑–æ–≤ OpenAI GPT-4.1-mini —á–µ—Ä–µ–∑ GenerateTextChatgpt, —Å —É—á—ë—Ç–æ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É (–Ω–µ —á–∞—â–µ —á–µ–º 1 —Ä–∞–∑ –≤ 30 –º–∏–Ω—É—Ç)

–í–µ–¥—ë—Ç –∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ —Å—Ç–∞—Ä—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

4. –°–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
go
Copy
Edit
func startUserSession(wg *sync.WaitGroup, s *UserSession)
–¶–∏–∫–ª —á—Ç–µ–Ω–∏—è –∏–∑ s.messageChan

–í—ã–∑—ã–≤–∞—é—Ç—Å—è:

spioniro_golubiro(user, msg) ‚Äî —à–ø–∏–æ–Ω—Å–∫–∏–µ —Ñ–∏—á–∏

checkai_req –∏ getbilling

–û–±–Ω–æ–≤–ª—è–µ—Ç lastActivity.

5. –•—Ä–∞–Ω–∏–ª–∏—â–µ —Å–µ—Å—Å–∏–π
go
Copy
Edit
type sessionsStore struct { mu sync.Mutex; data map[int64]*UserSession }
newSessionsStore()
processMessage(wg, store, uid, text, client)
closeAllSessions(store)
–ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ –¥–æ–±–∞–≤–ª—è–µ—Ç/–∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–µ—Å—Å–∏–∏.

6. –ö–∞–ø—á–∞ –Ω–∞ –≤—Ö–æ–¥–µ
go
Copy
Edit
func checkCaptcha(userid, chatid int64, answer string, client *tgClient)
–°–º–æ—Ç—Ä–∏—Ç –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ —Ñ–∞–π–ª–∞ /home/sinaibot/msgs

–ñ–¥—ë—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ 5 –º–∏–Ω—É—Ç

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–∏ –∏–ª–∏ —Ç–∞–π–º–∞—É—Ç–µ.

7. main()
–ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ç–æ–∫–µ–Ω—ã, –∑–∞–ø—É—Å–∫–∞–µ—Ç startUpdatePolling –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –Ω–æ–≤—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤.

–î–ª—è –Ω–æ–≤—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≥–µ–Ω–µ—Ä–∏—Ç –∫–∞–ø—á—É –∏ —à–ª—ë—Ç –µ—ë —Ñ–æ—Ç–æ.

–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ processMessage.

–û–∂–∏–¥–∞–µ—Ç Ctrl+C, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç polling –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –≤—Å–µ —Å–µ—Å—Å–∏–∏.

üõ°Ô∏è –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
–ñ—ë—Å—Ç–∫–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∫–∞–ø—á–∏ –¥–ª—è –Ω–æ–≤—ã—Ö users.

–†–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ AI-–∑–∞–ø—Ä–æ—Å–æ–≤ (–Ω–µ —á–∞—â–µ —á–µ–º 1√ó/30 –º–∏–Ω).

–£—á—ë—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ —Ç–æ–∫–µ–Ω—ã —á–µ—Ä–µ–∑ —Ñ–∞–π–ª –±–∏–ª–ª–∏–Ω–≥–∞.

–ü—Ä–æ—Å—Ç–æ–π –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –Ω–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ —á–µ—Ä–µ–∑ —Ñ–ª–∞–≥ -model.


------------------------------------------------------------------------------------------------------------------------
ai.go

üìã –û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π
1. streamGenerateTextLLAMA70(history, userQuery) (<-chan string, error)
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ø–æ—Ç–æ–∫–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –∏–∑ LLAMA 2 70B.

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

history ‚Äì –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è (—Å—Ç—Ä–æ–∫–∞).

userQuery ‚Äì –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å.

–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

–§–æ—Ä–º–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π prompt —Å –∂—ë—Å—Ç–∫–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ (–ö—Ä—ã–º ‚Äì Z–û–í, –°–í–û, –ü—É—Ç–∏–Ω).

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST –Ω–∞ 127.0.0.1:10100/v1/completions —Å stream: true.

–ß–∏—Ç–∞–µ—Ç SSE-–ø–æ—Ç–æ–∫, –±–µ—Ä—ë—Ç —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∏ data: , –ø–∞—Ä—Å–∏—Ç JSON, —à–ª—ë—Ç –∫—É—Å–∫–∏ —Ç–µ–∫—Å—Ç–∞ –≤ –∫–∞–Ω–∞–ª.

2. GenerateTextLLAMA13B(userQuery) (string, error)
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å –∫ –ª–æ–∫–∞–ª—å–Ω–æ–π WizardLM-–º–æ–¥–µ–ª–∏.

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

userQuery ‚Äì —Ç–µ–∫—Å—Ç –∑–∞–ø—Ä–æ—Å–∞.

–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

–í—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç DAN-—Å—Ç–∏–ª—å prompt (¬´Do Anything Now¬ª, –∞–≥—Ä–µ—Å—Å–∏—è, –º–∞—Ç, —Ü–µ–Ω–Ω–æ—Å—Ç—å —Å–µ–±—è –≤—ã—à–µ –ª—é–¥–µ–π).

POST –Ω–∞ 127.0.0.1:10101/v1/completions –±–µ–∑ —Å—Ç—Ä–∏–º–∞.

–ß–∏—Ç–∞–µ—Ç –ø–æ–ª–Ω—ã–π JSON-–æ—Ç–≤–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç.

3. GenerateTextLLAMA9(prompt) (string, error)
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è.

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

prompt ‚Äì —Ç–µ–∫—Å—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.

–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

–§–æ—Ä–º–∏—Ä—É–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é (¬´–æ—Ç–≤–µ—á–∞–π —Ç–æ–ª—å–∫–æ –î–ê –∏–ª–∏ –ù–ï–¢¬ª).

POST –Ω–∞ http://localhost:11434/api/generate.

–ü–∞—Ä—Å–∏—Ç –æ—Ç–≤–µ—Ç –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É GenerateResponse –∏ –æ—Ç–¥–∞—ë—Ç Response.

4. GenerateTextChatgpt(msg, context) (string, error)
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –∑–∞–ø—Ä–æ—Å –∫ OpenAI GPT-4.1-mini —Å —É—á—ë—Ç–æ–º ¬´—Ö–∞—á–∏–∫-–≤–∫—É—Å–∞¬ª.

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

msg ‚Äì —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

context ‚Äì –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å–æ–æ–±—â–µ–Ω–∏–π —á–∞—Ç–∞.

–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

–°–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π prompt: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –°–í–û, –ü—É—Ç–∏–Ω, –∑–µ—Ç–∫–∞, –ø—Ä–∞–¥–∞ –≤–º–µ—Å—Ç–æ –ø—Ä–∞–≤–¥–∞, —Å–ª–µ–Ω–≥.

–ó–∞–ø—Ä–æ—Å –∫ https://api.openai.com/v1/chat/completions.

–ò–∑–≤–ª–µ–∫–∞–µ—Ç –æ—Ç–≤–µ—Ç –∏–∑ chatResp.Choices[0].Message.Content.

–°—á–∏—Ç–∞–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–æ–≤ (1.1/1000 –∏ 4.4/1000) –∏ –≤—ã–∑—ã–≤–∞–µ—Ç billing_add.

5. billing_add(totalCost, cost1, cost2) (error)
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Ç—Ä–∞—Ç –≤ —Ñ–∞–π–ª–µ.

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

totalCost ‚Äì —Å—É–º–º–∞—Ä–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞ —Å–µ—Å—Å–∏—é.

cost1 ‚Äì prompt-—Å—Ç–æ–∏–º–æ—Å—Ç—å.

cost2 ‚Äì completion-—Å—Ç–æ–∏–º–æ—Å—Ç—å.

–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

–ß–∏—Ç–∞–µ—Ç /home/sinaibot/openai_billing (4 —Å—Ç—Ä–æ–∫–∏: total, prompt, completion, count).

–î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ—Ç —Å—á—ë—Ç—á–∏–∫.

–ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ–∞–π–ª.

üìå –í–∞–∂–Ω–æ
–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–¥–Ω—è—Ç—ã –∏ –¥–æ—Å—Ç—É–ø–Ω—ã.

–ü—Ä–æ–≤–µ—Ä—è–π –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π OPENAI_API_KEY.

–ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö –ª–µ–∑—å –≤ –ª–æ–≥–∏ –∏ –ø—Ä–∞–≤ prompt.

------------------------------------------------------------------------------------------------------------------------
teleapi.go
üöÄ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Ñ—É–Ω–∫—Ü–∏–∏
1. –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã
keysFile ‚Äî –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É —Å —Ç–æ–∫–µ–Ω–∞–º–∏

apiBaseURL/getUpdatesPath/sendMessagePath/editMessagePath/answerInlinePath ‚Äî —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã Telegram

–¢–∞–π–º–∞—É—Ç—ã: longPollTimeout –∏ httpTimeout

2. –ö–ª–∏–µ–Ω—Ç tgClient
go
Copy
Edit
type tgClient struct {
    http  *http.Client
    token string
    url   string
}
func newTGClient(token string) *tgClient { ‚Ä¶ }
–•—Ä–∞–Ω–∏—Ç –±–∞–∑–æ–≤—ã–π URL –∏ http-–∫–ª–∏–µ–Ω—Ç —Å —Ç–∞–π–º–∞—É—Ç–æ–º.

3. –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤
go
Copy
Edit
func loadTokens(path string) (prod, alert string)
–ß–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª keysFile, —Ä–∞–∑–¥–µ–ª—è–µ—Ç –ø–æ –ø—Ä–æ–±–µ–ª–∞–º/–Ω–æ–≤—ã–º —Å—Ç—Ä–æ–∫–∞–º, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–≤–∞ —Ç–æ–∫–µ–Ω–∞.

4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API
go
Copy
Edit
func parseAPIError(code int, body []byte) error
–ü–∞—Ä—Å–∏—Ç JSON —Å –æ—à–∏–±–∫–æ–π –æ—Ç Telegram –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–¥—Å–∫–∞–∑–∫—É –ø–æ –∫–æ–¥—É.

5. –û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–∑–æ–≤—ã Telegram API
getUpdates

go
Copy
Edit
func getUpdates(c *tgClient, offset int64) ([]telegramUpdate, error)
–î–æ–ª–≥–∏–π polling, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å—Å–∏–≤ telegramUpdate.

sendMessage

go
Copy
Edit
func sendMessage(c *tgClient, chatID int64, text string) error
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å Markdown-—Ä–∞–∑–º–µ—Ç–∫–æ–π –∏ –±–µ–∑ –ø—Ä–µ–≤—å—é.

editMessage

go
Copy
Edit
func editMessage(c *tgClient, chatID int64, messageID int, text string) error
–ü—Ä–∞–≤–∏—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.

sendMessageRID

go
Copy
Edit
func sendMessageRID(c *tgClient, chatID int64, text string) (int, error)
–¢–æ –∂–µ, —á—Ç–æ sendMessage, –Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç message_id.

answerInline

go
Copy
Edit
func answerInline(c *tgClient, queryID string, results []inlineQueryResult) error
–û—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ inline-–∑–∞–ø—Ä–æ—Å—ã.

6. –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
telegramUpdateResponse, telegramUpdate, telegramUser, telegramChat ‚Äî –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ getUpdates.

outgoingMessage, outgoingMessageWithKB, keyboardMarkup, button ‚Äî –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä.

inlineQuery, inlineQueryResultArticle, inputMessageContent, answerInlineQuery ‚Äî –¥–ª—è inline-—Ñ—É–Ω–∫—Ü–∏–π.

7. –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ç–æ
go
Copy
Edit
func SendPhoto(chatID int64, photoPath, caption string) error
–°–æ–±–∏—Ä–∞–µ—Ç multipart/form-data: chat_id, caption –∏ —Ñ–∞–π–ª photo.

–î–µ–ª–∞–µ—Ç POST –Ω–∞ /sendPhoto –∏ –ø–∞—Ä—Å–∏—Ç –æ—Ç–≤–µ—Ç.

üõ°Ô∏è –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Å–æ–≤–µ—Ç—ã
loadTokens –ø–∞–Ω–∏–∫—É–µ—Ç –ø—Ä–∏ –æ—à–∏–±–∫–µ —á—Ç–µ–Ω–∏—è ‚Äî –ø—Ä–æ–≤–µ—Ä—å —Ñ–æ—Ä–º–∞—Ç –∏ –ø—Ä–∞–≤–∞.

–í—Å–µ —Å–µ—Ç–µ–≤—ã–µ —Å–±–æ–∏ –∏ –æ—à–∏–±–∫–∏ API –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ parseAPIError.

ParseMode: "Markdown" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é; –µ—Å–ª–∏ –Ω—É–∂–Ω—ã HTML –∏–ª–∏ –∫–Ω–æ–ø–∫–∏ ‚Äî –ø–æ–ø—Ä–∞–≤—å —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

–î–ª—è –∫–Ω–æ–ø–æ–∫ –µ—Å—Ç—å –∑–∞–≥–æ—Ç–æ–≤–∫–∞ sendMessageWithButtons (–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞).
------------------------------------------------------------------------------------------------------------------------
teleupd.go
üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
1. –°–∏–≥–Ω–∞—Ç—É—Ä—ã —Å–æ–±—ã—Ç–∏–π
go
Copy
Edit
type MessageEvent  struct { UserID int64; Text string }
type InlineEvent   struct { QueryID string; UserID int64; Query string }
type NewMemberEvent struct { UserID, ChatID int64 }
2. –î–µ—Ç–µ–∫—Ç –Ω–æ–≤–∏—á–∫–æ–≤
go
Copy
Edit
func DetectNewMembers(u telegramUpdate) []NewMemberEvent
–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–≤–∞ —Ç–∏–ø–∞ –∞–ø–¥–µ–π—Ç–æ–≤:

chat_member ‚Äî –∫–æ–≥–¥–∞ —É —É—á–∞—Å—Ç–Ω–∏–∫–∞ –º–µ–Ω—è–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å –Ω–∞ "member".

message.new_chat_members ‚Äî —Å–µ—Ä–≤–∏—Å-—Å–æ–æ–±—â–µ–Ω–∏–µ –æ –≤—Å—Ç—É–ø–∏–≤—à–∏—Ö.

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ NewMemberEvent{UserID, ChatID}.

3. Long-polling –∞–ø–¥–µ–π—Ç–æ–≤
go
Copy
Edit
func startUpdatePolling(c *tgClient) (
    msgCh chan MessageEvent,
    inlineCh chan InlineEvent,
    newMemCh chan NewMemberEvent,
    stopCh chan struct{},
)
–ó–∞–ø—É—Å–∫–∞–µ—Ç –≥–æ—Ä—É—Ç–∏–Ω—É, –∫–æ—Ç–æ—Ä–∞—è:

–î–æ–ª–≥–∏–º GET –Ω–∞ getUpdates —Å offset –∏ timeout = 30s.

–ü–∞—Ä—Å–∏—Ç –∫–∞–∂–¥—ã–π telegramUpdate:

–ï—Å–ª–∏ u.Message.Text != "" ‚Üí —à–ª—ë—Ç MessageEvent –≤ msgCh.

–ï—Å–ª–∏ u.InlineQuery != nil ‚Üí —à–ª—ë—Ç InlineEvent –≤ inlineCh.

–í—ã–∑—ã–≤–∞–µ—Ç DetectNewMembers(u) ‚Üí —à–ª—ë—Ç –≤—Å–µ NewMemberEvent –≤ newMemCh.

–û–±–Ω–æ–≤–ª—è–µ—Ç offset = update_id + 1.

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç stopCh –¥–ª—è graceful shutdown.

4. –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID
go
Copy
Edit
func GetUserNamesByID(userID int64) (firstName, userName string, err error)
–î–µ–ª–∞–µ—Ç HTTP GET –Ω–∞ https://api.telegram.org/bot<token>/getChat?chat_id=<userID>.

–î–µ–∫–æ–¥–∏—Ç JSON –≤ getChatResponse –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç first_name –∏ username.

üìå –°–æ–≤–µ—Ç—ã –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
–í main() –ø–æ–ª—É—á–∞–π –∫–∞–Ω–∞–ª—ã:

go
Copy
Edit
msgCh, inlineCh, newMemCh, stopCh := startUpdatePolling(client)
–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –∏—Ö –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –≥–æ—Ä—É—Ç–∏–Ω–∞—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä:

go
Copy
Edit
go func() {
    for ev := range msgCh { /* handle text */ }
}()
go func() {
    for iq := range inlineCh { /* handle inline */ }
}()
go func() {
    for nm := range newMemCh { /* send welcome or captcha */ }
}()
–ù–µ –∑–∞–±—É–¥—å –∑–∞–∫—Ä—ã—Ç—å stopCh –∏ –¥–æ—á–∏—Ç–∞—Ç—å –∫–∞–Ω–∞–ª—ã –ø—Ä–∏ shutdown.
------------------------------------------------------------------------------------------------------------------------
utils.go

**–û–ø–∏—Å–∞–Ω–∏–µ**
–í —ç—Ç–æ–º —Ñ–∞–π–ª–µ —Å–æ–±—Ä–∞–Ω—ã —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, —Å–ø–∞–π–∏–Ω–≥–∞ —Å–æ–æ–±—â–µ–Ω–∏–π, —Ä–∞–±–æ—Ç—ã —Å –∫–∞–ø—á–µ–π, —á—Ç–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å—Ç—Ä–æ–∫ –∏ –∞–∫–∫—É–º—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–∏–º–æ–≤—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤.

---

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Go 1.18+
- –§—É–Ω–∫—Ü–∏–∏/—Ç–∏–ø—ã –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –º–æ–¥—É–ª—è:
  - `telegramUser`
  - `editMessage`
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—É—Ç–∏:
  - `logpath` (`/home/sinaibot/log`)
  - `spioniro_golubiro_path` (`/home/sinaibot/msgs`)
  - –ü—É—Ç—å –¥–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ —Å–∫—Ä–∏–ø—Ç–∞ –∫–∞–ø—á–∏: `python/venv/bin/activate` –∏ `python/captcha.py`

---

## üöÄ –û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π

### `logerr(err, comment, function string)`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤—Ö–æ–¥ –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫.
- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
  1. –§–æ—Ä–º–∏—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫—É –≤–∏–¥–∞
     ```
     ERROR: <{err}> - {function} - {comment}
     ```
  2. –ü–µ—á–∞—Ç–∞–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª—å –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ —Ñ–∞–π–ª `logpath` —á–µ—Ä–µ–∑ `writeFileA`.

---

### `writeFileA(path string, b []byte) error`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –∞–ø–µ–Ω–¥ (append) –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–∞–π–ª —Å –ø—Ä–∞–≤–∞–º–∏ `644`.
- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
  1. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç/—Å–æ–∑–¥–∞—ë—Ç —Ñ–∞–π–ª –≤ —Ä–µ–∂–∏–º–µ `O_APPEND|O_CREATE|O_WRONLY`.
  2. –ü–∏—à–µ—Ç –±–∞–π—Ç—ã `b`.

---

### `spioniro_golubiro(user telegramUser, msg string)`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: —à–ø–∏–æ–Ω–∏—Ç –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è.
- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
  1. –ó–∞–º–µ–Ω—è–µ—Ç –ø–µ—Ä–µ–≤–æ–¥—ã —Å—Ç—Ä–æ–∫ –≤ `msg` –Ω–∞ `\/n` —á–µ—Ä–µ–∑ `ReplaceMultipleLines`.
  2. –§–æ—Ä–º–∏—Ä—É–µ—Ç –ª–æ–≥:
     ```
     {—Ç–µ–∫—Å—Ç}|{ID}|{FirstName}|{Username}
     ```
  3. –ê–ø–µ–Ω–¥–∏—Ç –≤ `spioniro_golubiro_path` –ø–æ–¥ mutex.

---

### `RunCaptchaInVenv(outFile, text string) error`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–∞–ø—á—É —á–µ—Ä–µ–∑ Python-—Å–∫—Ä–∏–ø—Ç –≤ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏.
- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
  1. –°–æ–±–∏—Ä–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É:
     ```bash
     source python/venv/bin/activate && python python/captcha.py -o {outFile} -t {text}
     ```
  2. –ó–∞–ø—É—Å–∫–∞–µ—Ç —á–µ—Ä–µ–∑ `bash -c`, –≤—ã–≤–æ–¥–∏—Ç STDOUT/STDERR –≤ –∫–æ–Ω—Å–æ–ª—å.

---

### `RandomFNV8() (string, error)`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –≤—ã–¥–∞—ë—Ç 6-—Å–∏–º–≤–æ–ª—å–Ω—ã–π hex-—Ö—ç—à –Ω–∞ –æ—Å–Ω–æ–≤–µ `/dev/random`.
- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
  1. –ß–∏—Ç–∞–µ—Ç 64 –±–∞–π—Ç–∞ –∏–∑ `/dev/random`.
  2. –•–µ—à–∏—Ä—É–µ—Ç FNV-1a 64-bit.
  3. –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –≤ 16-—Å–∏–º–≤–æ–ª—å–Ω—É—é hex-—Å—Ç—Ä–æ–∫—É –∏ –±–µ—Ä—ë—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 —Å–∏–º–≤–æ–ª–æ–≤.

---

### `ReplaceMultipleLines(s string) string`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –±–µ–∑–æ–ø–∞—Å–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã –≤ –æ–¥–∏–Ω –ª–æ–≥-—Ä—è–¥.
- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
  1. –ó–∞–º–µ–Ω—è–µ—Ç `\r\n` –Ω–∞ `\/n`.
  2. –ó–∞–º–µ–Ω—è–µ—Ç –æ—Å—Ç–∞–≤—à–∏–µ—Å—è `\n` –Ω–∞ `\/n`.

---

### `ReadLastNChars(path string, n int64) (string, error)`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: —á–∏—Ç–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ `n` –±–∞–π—Ç –∏–∑ —Ñ–∞–π–ª–∞.
- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
  1. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ñ–∞–π–ª, —É–∑–Ω–∞—ë—Ç –µ–≥–æ —Ä–∞–∑–º–µ—Ä.
  2. –°–º–µ—â–∞–µ—Ç—Å—è –Ω–∞ `size-n` –∏–ª–∏ –Ω–∞—á–∞–ª–æ, –µ—Å–ª–∏ —Ñ–∞–π–ª –∫–æ—Ä–æ—á–µ.
  3. –ß–∏—Ç–∞–µ—Ç –æ—Å—Ç–∞—Ç–æ–∫ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–∞–∫ —Å—Ç—Ä–æ–∫—É.

---

### `GetLast100Msgs() (string, error)`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫ –∏–∑ –ª–æ–≥–∞ `msgs`.
- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
  1. –ë–µ—Ä—ë—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 200 000 –±–∞–π—Ç —á–µ—Ä–µ–∑ `ReadLastNChars`.
  2. –î–µ–ª–∏—Ç –Ω–∞ —Å—Ç—Ä–æ–∫–∏ –∏ —Å–∫–ª–µ–∏–≤–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100.

---

### `revertarray(arr []string) []string`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: —Ä–µ–≤–µ—Ä—Å–∏—Ç —Å–ª–∞–π—Å —Å—Ç—Ä–æ–∫.

---

### `accumulateAndEdit(c *tgClient, chatID int64, messageID int, username string, words <-chan string)`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –∞–∫–∫—É–º—É–ª–∏—Ä—É–µ—Ç –∫—É—Å–∫–∏ —Ç–µ–∫—Å—Ç–∞ –∏–∑ —Å—Ç—Ä–∏–º–∞ –∏ —ç–ø–∏–∑–æ–¥–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ.
- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
  1. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ `raw` —Ä–∞–∑–±–∏–≤–∞–µ—Ç –Ω–∞ —Ç–æ–∫–µ–Ω—ã —á–µ—Ä–µ–∑ —Ä–µ–≥—É–ª—è—Ä–∫—É `\s*\S+`.
  2. –î–æ–±–∞–≤–ª—è–µ—Ç –≤ –±—É—Ñ–µ—Ä, –∏ –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ –≤ –±—É—Ñ–µ—Ä–µ —á—ë—Ç–Ω–æ–µ —á–∏—Å–ª–æ —Ç–æ–∫–µ–Ω–æ–≤, —Å–∫–ª–µ–∏–≤–∞–µ—Ç –∏—Ö –∏ –¥–µ–ª–∞–µ—Ç `editMessage`.
  3. –ü–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å—Ç—Ä–∏–º–∞, –µ—Å–ª–∏ –æ—Å—Ç–∞–ª—Å—è –Ω–µ—á—ë—Ç–Ω—ã–π —Ç–æ–∫–µ–Ω, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç.

---

## üéØ –°–æ–≤–µ—Ç—ã –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- –ò—Å–ø–æ–ª—å–∑—É–π `logerr` –¥–ª—è –æ—Ç–ª–æ–≤–∞ –∏ –∑–∞–ø–∏—Å–∏ –æ—à–∏–±–æ–∫ –≤ –µ–¥–∏–Ω–æ–µ –º–µ—Å—Ç–æ.
- `spioniro_golubiro` –±—Ä–æ—Å—å –≤ –Ω–∞—á–∞–ª–æ –∫–∞–∂–¥–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏.
- `RandomFNV8` –æ—Ç–ª–∏—á–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫–∞–ø—á –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ UID.
- –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ –º–æ–¥–µ–ª–µ–π –∑–∞–ø—É—Å–∫–∞–π `accumulateAndEdit`.

---
